CREATE DATABASE [animatv_kernel]
GO

USE [animatv_kernel]
GO

CREATE TABLE [Role]
(
	ID NVARCHAR(50) PRIMARY KEY NOT NULL,
	[Value] NVARCHAR(50) NOT NULL
)
GO

CREATE TABLE [User]
(
	ID NVARCHAR(50) PRIMARY KEY NOT NULL,
	[FIrstName] NVARCHAR(50) NOT NULL,
	[SecondName] NVARCHAR(50) NOT NULL,
	[LastName] NVARCHAR(50),
	[Phone] NVARCHAR(50) NOT NULL,
	[Email] NVARCHAR(50) NOT NULL,
	[NickName] NVARCHAR(20) NOT NULL,
	[Password] NVARCHAR(25) NOT NULL,
	[AddressID] NVARCHAR(50) NOT NULL,
	[Avatar] IMAGE,
	[Description] NVARCHAR(MAX) NOT NULL,
	[Rate] NVARCHAR(10) NOT NULL,
	[RoleID] NVARCHAR(50) FOREIGN KEY REFERENCES [Role](ID) NOT NULL
)
GO

CREATE TABLE [Video]
(
	ID NVARCHAR(50) PRIMARY KEY NOT NULL,
	[Value] NVARCHAR(100) NOT NULL
)
GO

CREATE TABLE [UserOfVideo]
(
	[UserID] NVARCHAR(50) FOREIGN KEY REFERENCES [User](ID) NOT NULL,
	[VideoID] NVARCHAR(50) FOREIGN KEY REFERENCES [Video](ID) NOT NULL,
	PRIMARY KEY([UserID], [VideoID])
)
GO

CREATE TABLE [TermSubscription]
(
	ID NVARCHAR(50) PRIMARY KEY NOT NULl,
	[Value] NVARCHAR(50) NOT NULL
)
GO

CREATE TABLE [SubscrationType]
(
	ID NVARCHAR(50) PRIMARY KEY NOT NULL,
	[Value] NVARCHAR(50) NOT NULL
)
GO

CREATE TABLE [Subscription]
(
	ID NVARCHAR(50) PRIMARY KEY NOT NULL,
	[RightID] NVARCHAR(50) NOT NULL,
	[SubscrationTypeID] NVARCHAR(50) FOREIGN KEY REFERENCES [SubscrationType](ID) NOT NULL,
	[TermSubscriptionID] NVARCHAR(50) FOREIGN KEY REFERENCES [TermSubscription](ID) NOT NULL
) 
GO

CREATE TABLE [Payer]
(
	[ID] NVARCHAR(50) PRIMARY KEY NOT NULL,
	[Phone] NVARCHAR(50) NOT NULL,
	[Email] NVARCHAR(50) NOT NULL,
	[CardholderName] NVARCHAR(50) NOT NULL
)
GO

CREATE TABLE [UserOfSubscription]
(
	[ID] NVARCHAR(50) PRIMARY KEY NOT NULL,
	[UserID] NVARCHAR(50) FOREIGN KEY REFERENCES [User](ID) NOT NULL,
	[SubscriptionID] NVARCHAR(50) FOREIGN KEY REFERENCES [Subscription](ID) NOT NULL,
	[StartDate] DATE NOT NULL,
	[EndDate] DATE NOT NULL,

)
GO

CREATE TABLE [PayerOfUserSubscription]
(
	[PayerID] NVARCHAR(50) FOREIGN KEY REFERENCES [Payer](ID) NOT NULL,
	[UserOfSubscriptionID] NVARCHAR(50) FOREIGN KEY REFERENCES [UserOfSubscription](ID) NOT NULL,
	PRIMARY KEY([PayerID], [UserOfSubscriptionID])
)
GO